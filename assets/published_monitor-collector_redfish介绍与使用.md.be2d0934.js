import{_ as s,o as a,c as o,Q as e}from"./chunks/framework.36bc40e2.js";const E=JSON.parse('{"title":"介绍","description":"","frontmatter":{},"headers":[],"relativePath":"published/monitor-collector/redfish介绍与使用.md","filePath":"published/monitor-collector/redfish介绍与使用.md","lastUpdated":1700106669000}'),n={name:"published/monitor-collector/redfish介绍与使用.md"},p=e(`<h1 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h1><ul><li><p><code>Redfish</code> 是一种管理标准，它使用 <code>HTTP RESTful</code> 接口的数据模型表示法，此模型以标准的机器可读模式表示，其消息负载以 <code>JSON</code> 来表示，和普通的浏览器访问站点一样</p></li><li><p>协议本身利用了<code> OData v4</code> 版本，<code>Redfish API</code> 是 <code>HTTP API</code>，可通过统一的接口来表示，各种实现<code>Redfish API </code>提供数据中心资源管理、事件处理、长时间任务以及发现等机制</p></li></ul><h2 id="版本" tabindex="-1">版本 <a class="header-anchor" href="#版本" aria-label="Permalink to &quot;版本&quot;">​</a></h2><ul><li>协议版本：协议版本包含在<code>URI</code>中，从<code>/redfish/v1/</code>开始，这表示正在访问协议版本，<code>V1</code>版本是目前唯一的版本，但未来会有其它版本，以这种方式开头的<code>URI</code>表示实现方法符合<code>Redfish</code>规范<code>V1</code>版本</li><li>资源模式版本: 资源类型在带有版本的命名空间中定义，每个资源实例的类型由<code>OData</code>类型注释<code>@odata.type</code>来表示，类型注释的值是资源类型<code>URI</code>，包括带有版本的命名空间，<code>@odata.type: # ServiceRoot.1.0.0.ServiceRoot</code>表示处理的是<code>ServiceRoot</code>模式<code>1.0.0</code>版本中定义的<code>ServiceRoot</code>类型的资源，相应的模式文件位于<code>Redfish</code>模式库的<code>/schema /v1/ServiceRoot</code>路径下，因此，此类型的完整<code>URI</code>是<code>/schema/v1/ServiceRoot#ServiceRoot.1.0.0.ServiceRoot</code></li></ul><h2 id="python-client操作库" tabindex="-1"><code>python client</code>操作库 <a class="header-anchor" href="#python-client操作库" aria-label="Permalink to &quot;\`python client\`操作库&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">https://github.com/DMTF/python-redfish-library</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">https://github.com/DMTF/python-redfish-library</span></span></code></pre></div><p>从操作库的代码来看，<code>redfish</code>有些服务需要账号密码，可以采用<code>session</code>会话保持的方式，也可以采用<code>Basic Authorization</code>方式认证</p><p><code>Basic Authorization</code>认证</p><p>假设现在有账号<code>user-a</code>， 密码<code>pass-a</code>，计算出认证参数如下</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&gt;&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> base64</span></span>
<span class="line"><span style="color:#F97583;">&gt;&gt;&gt;</span><span style="color:#E1E4E8;"> base64.b64encode(</span><span style="color:#9ECBFF;">&#39;user-a:pass-a&#39;</span><span style="color:#E1E4E8;">.encode(</span><span style="color:#9ECBFF;">&#39;utf-8&#39;</span><span style="color:#E1E4E8;">)).decode(</span><span style="color:#9ECBFF;">&#39;utf-8&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#9ECBFF;">&#39;dXNlci1hOnBhc3MtYQ==&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&gt;&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> base64</span></span>
<span class="line"><span style="color:#D73A49;">&gt;&gt;&gt;</span><span style="color:#24292E;"> base64.b64encode(</span><span style="color:#032F62;">&#39;user-a:pass-a&#39;</span><span style="color:#24292E;">.encode(</span><span style="color:#032F62;">&#39;utf-8&#39;</span><span style="color:#24292E;">)).decode(</span><span style="color:#032F62;">&#39;utf-8&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#032F62;">&#39;dXNlci1hOnBhc3MtYQ==&#39;</span></span></code></pre></div><p>在请求头<code>headers</code>中加入参数<code>Authorization: Basic dXNlci1hOnBhc3MtYQ==</code>完成认证了</p><h2 id="python-mock-server" tabindex="-1"><code>python mock server</code> <a class="header-anchor" href="#python-mock-server" aria-label="Permalink to &quot;\`python mock server\`&quot;">​</a></h2><p>由于<code>redfish</code>服务需要硬件厂商支持，并开放相应服务，所以<code>DMTF</code>项目提供了一个可供测试使用的<code>redfish server</code></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">https://github.com/DMTF/Redfish-Mockup-Server</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">https://github.com/DMTF/Redfish-Mockup-Server</span></span></code></pre></div><p>可以通过<code>docker</code>启动服务，开放8000端口</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">$ docker run --rm -p8000:8000 dmtf/redfish-mockup-server:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">$ docker run --rm -p8000:8000 dmtf/redfish-mockup-server:latest</span></span></code></pre></div><p>依据<code>mock server</code>项目的配置文件, 该<code>redfish server</code>提供的接口包含了<code>/redfish/v1/Systems, /redfish/v1/Chassis...</code>等</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">https://github.com/DMTF/Redfish-Mockup-Server/blob/main/public-rackmount1/index.json</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">https://github.com/DMTF/Redfish-Mockup-Server/blob/main/public-rackmount1/index.json</span></span></code></pre></div><p>使用<code>curl</code>工具测试服务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8000/redfish/v1/Systems</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;@odata.id&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/redfish/v1/Systems&quot;,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;@odata.type&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;#ComputerSystemCollection.ComputerSystemCollection&quot;,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;Members&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#E1E4E8;">        {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">&quot;@odata.id&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/redfish/v1/Systems/437XR1138R2&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    ],</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;Members@odata.count&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;Name&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Computer System Collection&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8000/redfish/v1/TaskService</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8000/redfish/v1/Systems</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;@odata.id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/redfish/v1/Systems&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;@odata.type&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;#ComputerSystemCollection.ComputerSystemCollection&quot;,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;Members&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">&quot;@odata.id&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/redfish/v1/Systems/437XR1138R2&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;Members@odata.count&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;Name&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Computer System Collection&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8000/redfish/v1/TaskService</span></span></code></pre></div><p>如果需要带上认证信息，可以修改命令为</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-H</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Authorization: Basic dXNlci1hOnBhc3MtYQ==&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8000/redfish/v1/Systems</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-H</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Authorization: Basic dXNlci1hOnBhc3MtYQ==&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8000/redfish/v1/Systems</span></span></code></pre></div><h2 id="参考阅读" tabindex="-1">参考阅读 <a class="header-anchor" href="#参考阅读" aria-label="Permalink to &quot;参考阅读&quot;">​</a></h2><p><a href="https://www.dmtf.org/sites/default/files/DSP2044%20Redfish%20%E7%99%BD%E7%9A%AE%E4%B9%A6%201.0.0.pdf" target="_blank" rel="noreferrer"><code>DSP2044 Redfish 白皮书 1.0.0</code></a></p>`,24),l=[p];function t(c,r,d,i,y,h){return a(),o("div",null,l)}const F=s(n,[["render",t]]);export{E as __pageData,F as default};
