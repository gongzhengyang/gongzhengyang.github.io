import{_ as s,o as a,c as o,Q as l}from"./chunks/framework.ec8f7e8e.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"published/monitor-collector/不同操作系统日志获取.md","filePath":"published/monitor-collector/不同操作系统日志获取.md"}'),e={name:"published/monitor-collector/不同操作系统日志获取.md"},n=l('<p>获取系统日志数据的命令</p><h4 id="linux-android" tabindex="-1"><code>linux/android</code> <a class="header-anchor" href="#linux-android" aria-label="Permalink to &quot;`linux/android`&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dmesg</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-Tw</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dmesg</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-Tw</span></span></code></pre></div><h4 id="freebsd" tabindex="-1"><code>freebsd</code> <a class="header-anchor" href="#freebsd" aria-label="Permalink to &quot;`freebsd`&quot;">​</a></h4><p>由于缺少像<code>dmesg</code>一样的工具，所以需要直接去读取文件</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">less</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/log/messages</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">less</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/log/messages</span></span></code></pre></div><h4 id="macos" tabindex="-1"><code>macos</code> <a class="header-anchor" href="#macos" aria-label="Permalink to &quot;`macos`&quot;">​</a></h4><p>封装了<code>log</code>命令行工具</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 获取历史log 数据</span></span>\n<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">log</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">show</span></span>\n<span class="line"><span style="color:#6A737D;"># 获取最新log流数据，该命令是阻塞的</span></span>\n<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">log</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stream</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 获取历史log 数据</span></span>\n<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">log</span><span style="color:#24292E;"> </span><span style="color:#032F62;">show</span></span>\n<span class="line"><span style="color:#6A737D;"># 获取最新log流数据，该命令是阻塞的</span></span>\n<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">log</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stream</span></span></code></pre></div><h4 id="windows" tabindex="-1"><code>windows</code> <a class="header-anchor" href="#windows" aria-label="Permalink to &quot;`windows`&quot;">​</a></h4><p>采用<code>powershell</code>终端命令获取</p><p>如下表示</p><ul><li>调用<code>Get-WinEvent</code>程序</li><li>获取日志名称为<code>System</code>的，</li><li><code>-Oldest</code>获取日志时间从旧往新排序</li><li><code>-Force</code>表示当名称参数的值包含通配符</li><li>时，需要使用 <code>Force</code> 参数才能获取调试或分析日志</li><li><code>| Format-List -Property * </code>表示使用管道的方式把输出格式转换一下，转变为一列一行的形式输出数据</li></ul><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">PS</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-WinEvent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">LogName System </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Oldest </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Force </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Format-List</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Property </span><span style="color:#F97583;">*</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">PS</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-WinEvent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">LogName System </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Oldest </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Force </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Format-List</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Property </span><span style="color:#D73A49;">*</span></span></code></pre></div><p>如果是在命令行中调用，容易遇到<code>utf-8</code>编码失败问题，如果上层程序不太好处理，可以通过命令行中指定以<code>utf-8</code>编码重定向到一个文件去读取数据</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">PS</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-WinEvent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">LogName System </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Oldest </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Force </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Format-List</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Property </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">out-file</span><span style="color:#E1E4E8;"> test.log </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">encoding utf8</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">PS</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-WinEvent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">LogName System </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Oldest </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Force </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Format-List</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Property </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">out-file</span><span style="color:#24292E;"> test.log </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">encoding utf8</span></span></code></pre></div><h2 id="参考阅读" tabindex="-1">参考阅读 <a class="header-anchor" href="#参考阅读" aria-label="Permalink to &quot;参考阅读&quot;">​</a></h2><p><a href="https://learn.microsoft.com/zh-cn/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7.3" target="_blank" rel="noreferrer"><code>Get-WinEvent microsoft 文档</code></a></p>',18),p=[n];function t(c,r,i,y,d,E){return a(),o("div",null,p)}const g=s(e,[["render",t]]);export{F as __pageData,g as default};
