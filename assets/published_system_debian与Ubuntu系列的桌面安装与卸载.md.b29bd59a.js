import{_ as s,o as a,c as n,Q as o}from"./chunks/framework.ec8f7e8e.js";const p="/assets/gnome-server.e50d0b12.png",l="/assets/gnome-desktop.71fbc8f8.png",e="/assets/gnome-desktop-htop.7712048d.png",t="/assets/gnome-server-htop.dbb9c0d9.png",B=JSON.parse('{"title":"背景","description":"","frontmatter":{},"headers":[],"relativePath":"published/system/debian与Ubuntu系列的桌面安装与卸载.md","filePath":"published/system/debian与Ubuntu系列的桌面安装与卸载.md"}'),c={name:"published/system/debian与Ubuntu系列的桌面安装与卸载.md"},r=o('<h1 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h1><p>最近发现使用银河麒麟操作系统，选择飞腾版本的<code>Debian/Ubuntu</code>系列的系统，发现是带有桌面的，但是机器作为服务器使用，只需要带有终端可以接上显示器就行，<strong>不需要为没有用到的服务买单</strong></p><p>下面采用<code>Ubuntu22.04</code>操作系统进行桌面的安装与卸载进行演示</p><h2 id="桌面安装" tabindex="-1">桌面安装 <a class="header-anchor" href="#桌面安装" aria-label="Permalink to &quot;桌面安装&quot;">​</a></h2><p>在<a href="https://ubuntu.com/download/server" target="_blank" rel="noreferrer"><code>Ubuntu</code>官方网站</a>下载一个服务器版本的镜像</p><p>系统安装完成之后进入系统，发现只有一个黑黑的终端</p><p><img src="'+p+`" alt="image-20221128095224188"></p><p>目前大多数主流<code>linux</code>所采用的桌面系统都是<code>gnome</code>，其他一些像<code>Kubuntu</code>这种自带<code>kde</code>桌面的系统也有一些</p><p>现在开始安装桌面，这条命令执行的时候会下载一大堆东西，主要是<code>gnome-*</code>和<code>xserver-xorg-*</code>这些的，<code>Ubuntu</code>的桌面版比服务器版本多执行了这一条命令，外加上一些桌面<code>UI</code>的调优美化</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gnome</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">//</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--snip</span></span>
<span class="line"><span style="color:#B392F0;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">upgraded,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1017</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">newly</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">installed,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">remove</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">44</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">upgraded.</span></span>
<span class="line"><span style="color:#B392F0;">Need</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">572</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">archives.</span></span>
<span class="line"><span style="color:#B392F0;">After</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">this</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">operation,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1894</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">additional</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">disk</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">space</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">will</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used.</span></span>
<span class="line"><span style="color:#B392F0;">Do</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">want</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">continue?</span><span style="color:#E1E4E8;"> [Y/n]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gnome</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">//</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--snip</span></span>
<span class="line"><span style="color:#6F42C1;">2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">upgraded,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1017</span><span style="color:#24292E;"> </span><span style="color:#032F62;">newly</span><span style="color:#24292E;"> </span><span style="color:#032F62;">installed,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">remove</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">44</span><span style="color:#24292E;"> </span><span style="color:#032F62;">not</span><span style="color:#24292E;"> </span><span style="color:#032F62;">upgraded.</span></span>
<span class="line"><span style="color:#6F42C1;">Need</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">572</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">archives.</span></span>
<span class="line"><span style="color:#6F42C1;">After</span><span style="color:#24292E;"> </span><span style="color:#032F62;">this</span><span style="color:#24292E;"> </span><span style="color:#032F62;">operation,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1894</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">additional</span><span style="color:#24292E;"> </span><span style="color:#032F62;">disk</span><span style="color:#24292E;"> </span><span style="color:#032F62;">space</span><span style="color:#24292E;"> </span><span style="color:#032F62;">will</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used.</span></span>
<span class="line"><span style="color:#6F42C1;">Do</span><span style="color:#24292E;"> </span><span style="color:#032F62;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">want</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">continue?</span><span style="color:#24292E;"> [Y/n]</span></span></code></pre></div><p>安装完成之后重启机器，发现有输入密码的界面弹出来，最后桌面长这个样子，虽然是<code>Ubuntu22</code>系统，但是系统壁纸是<code>debian</code>的，鼠标移动的时候发现是一个正方形框框，看得出来<code>Ubuntu</code>的桌面版应该还是做了很多优化与调整工作的</p><p><img src="`+l+'" alt="image-20221128102236456"></p><p>执行<code>htop</code>命令，按照内存使用大小倒排，发现<code>gnome</code>桌面所使用的资源还是蛮多的</p><p><img src="'+e+`" alt="image-20221128103711409"></p><p>所以如果一台机器是作为服务器使用，就把桌面卸载了吧，把资源留给更重要的程序</p><h2 id="卸载" tabindex="-1">卸载 <a class="header-anchor" href="#卸载" aria-label="Permalink to &quot;卸载&quot;">​</a></h2><p>执行如下命令，该条命令会匹配<code>gnome*</code>和<code>gnome-shell</code>软件，并且卸载</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">purge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gnome</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gnome-shell</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">purge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gnome</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gnome-shell</span></span></code></pre></div><p>如果上面命令执行失败，需要查看具体安装了哪些包，具体去指定包名称卸载</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dpkg</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-l</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gnome</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dpkg</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-l</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gnome</span></span></code></pre></div><p>一般执行如下命令，界面基本就卸载完了</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">purge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gnome-shell</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">purge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gnome-shell</span></span></code></pre></div><p>卸载显示服务器（桌面环境如<code>Gnome</code>，<code>KDE</code>, <code>MATE</code>会使用显示服务器与内核交互，<code>xorg</code>接收键盘鼠标输入和负责屏幕输出窗口的移动，窗口标题的样式等等）</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">purge</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">xserver-xorg</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">purge</span><span style="color:#24292E;"> </span><span style="color:#032F62;">xserver-xorg</span></span></code></pre></div><p>最后清理无用软件包</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">autoremove</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">autoremove</span></span></code></pre></div><p>最后重启机器就行了</p><h2 id="卸载重启之后的错误处理" tabindex="-1">卸载重启之后的错误处理 <a class="header-anchor" href="#卸载重启之后的错误处理" aria-label="Permalink to &quot;卸载重启之后的错误处理&quot;">​</a></h2><p>麒麟系统卸载完成桌面之后，连接显示器，会弹出来一个鼠标图案，然后界面会一直卡住不动</p><p>这个时候需要<code>ssh</code>上去服务器，修改<code>/etc/default/grub</code></p><p>找到一行配置，此处修改内核启动参数，设置开机进入文本模式</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;quiet splash&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 或者</span></span>
<span class="line"><span style="color:#F97583;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;quiet splash&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 或者</span></span>
<span class="line"><span style="color:#D73A49;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;&quot;</span></span></code></pre></div><p>修改为</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;text&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;text&quot;</span></span></code></pre></div><p>更新配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update-grub</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set-default</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">multi-user.target</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">reboot</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update-grub</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set-default</span><span style="color:#24292E;"> </span><span style="color:#032F62;">multi-user.target</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">reboot</span></span></code></pre></div><p>后面启动系统，连接显示器以后就直接进入终端操作界面了</p><h2 id="检查卸载之后的系统负载" tabindex="-1">检查卸载之后的系统负载 <a class="header-anchor" href="#检查卸载之后的系统负载" aria-label="Permalink to &quot;检查卸载之后的系统负载&quot;">​</a></h2><p><code>htop</code>命令按照内存使用排序</p><p><img src="`+t+'" alt="image-20221128110105106"></p><h2 id="参考阅读" tabindex="-1">参考阅读 <a class="header-anchor" href="#参考阅读" aria-label="Permalink to &quot;参考阅读&quot;">​</a></h2><p><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/desktop_migration_and_administration_guide/introducing-gnome3-desktop#gnome3" target="_blank" rel="noreferrer"><code>redhat</code>的<code>gnome</code>桌面介绍</a></p><p><a href="https://baike.baidu.com/item/xorg/153425" target="_blank" rel="noreferrer"><code>xorg</code>百度百科</a></p>',43),E=[r];function y(d,i,F,u,h,g){return a(),n("div",null,E)}const b=s(c,[["render",y]]);export{B as __pageData,b as default};
